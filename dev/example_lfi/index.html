<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example: LFI · BOLFI.jl</title><meta name="title" content="Example: LFI · BOLFI.jl"/><meta property="og:title" content="Example: LFI · BOLFI.jl"/><meta property="twitter:title" content="Example: LFI · BOLFI.jl"/><meta name="description" content="Documentation for BOLFI.jl."/><meta property="og:description" content="Documentation for BOLFI.jl."/><meta property="twitter:description" content="Documentation for BOLFI.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BOLFI.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">BOLFI.jl</a></li><li><a class="tocitem" href="../lfi/">Likelihood-Free Inference Problem</a></li><li><a class="tocitem" href="../lfss/">Sensor Selection Problem</a></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../types/">Data Types</a></li><li><a class="tocitem" href="../hyperparams/">Hyperparameters</a></li><li class="is-active"><a class="tocitem" href>Example: LFI</a><ul class="internal"><li><a class="tocitem" href="#Problem-Definition"><span>Problem Definition</span></a></li><li><a class="tocitem" href="#Sampling-Initial-Data"><span>Sampling Initial Data</span></a></li><li><a class="tocitem" href="#Problem-Hyperparameters"><span>Problem Hyperparameters</span></a></li><li><a class="tocitem" href="#Acquisition-Function"><span>Acquisition Function</span></a></li><li><a class="tocitem" href="#Instantiate-BolfiProblem"><span>Instantiate <code>BolfiProblem</code></span></a></li><li><a class="tocitem" href="#Running-BOLFI"><span>Running BOLFI</span></a></li><li class="toplevel"><a class="tocitem" href="#Plots"><span>Plots</span></a></li></ul></li><li><a class="tocitem" href="../example_lfss/">Example: LFSS</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example: LFI</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example: LFI</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/soldasim/BOLFI.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/soldasim/BOLFI.jl/blob/master/docs/src/example_lfi.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-LFI"><a class="docs-heading-anchor" href="#Example:-LFI">Example: LFI</a><a id="Example:-LFI-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-LFI" title="Permalink"></a></h1><p>This page showcases the use of BOLFI.jl on a simple toy problem. The source code for the showcased problem is also available at <a href="https://github.com/soldasim/BOLFI.jl/tree/master/examples/simple">github</a>.</p><p>The example requires the following packages to be loaded.</p><pre><code class="language-julia hljs">using BOLFI
using BOSS
using Distributions
using OptimizationPRIMA</code></pre><h2 id="Problem-Definition"><a class="docs-heading-anchor" href="#Problem-Definition">Problem Definition</a><a id="Problem-Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Definition" title="Permalink"></a></h2><p>In our toy problem, our goal is to infer two parameters <span>$x \in \mathbb{R}^2$</span>. We defined the true <em>unknown</em> mapping <span>$f_t(x) = g_t(x) = \prod x$</span>.</p><pre><code class="language-julia hljs">f_(x) = x[1] * x[2]</code></pre><p><em>(Note that we refer to the parameters as <code>x</code> here, inteas of <span>$x$</span>, to be consistent with the source code of BOLFI.jl.)</em></p><p>We have observed the single observation <span>$\prod x = 1.$</span>.</p><pre><code class="language-julia hljs">z_obs = [1.]</code></pre><p>The experiment is assumed to follow a Normal likelihood with observation noise deviation <span>$\sigma_f = 0.5$</span>.</p><pre><code class="language-julia hljs">likelihood = NormalLikelihood(; z_obs, obs_std=[0.5])</code></pre><p>We define the noisy simulation function <span>$g(x)$</span>. The <em>unknown</em> simulation noise deviatoin is set to <span>$\sigma_g = 0.001$</span>.</p><pre><code class="language-julia hljs">function simulation(x; noise_std=0.001)
    y = f_(x) + rand(Normal(0., noise_std))
    return [y]
end</code></pre><p>Then we need to define the objective function for the Gaussian processes to query data from. This function should take a vector of parameters <span>$x$</span> as the input, and return the simulated outputs <span>$y(x)$</span>.</p><pre><code class="language-julia hljs">gp_objective(x) = simulation(x)</code></pre><p>We will limit the domain to a <span>$x \in [-5,5]^2$</span>.</p><pre><code class="language-julia hljs">bounds = ([-5, -5], [5, 5])</code></pre><p>Finally, we define the parameter prior. We may for example know, that the parameter values around zero are more realistic. In such case, we might use a normal distribution centered around zero. The parameter prior should be defined as a single multivariate distribution.</p><pre><code class="language-julia hljs">x_prior = Product(fill(
    Normal(0., 5/3),
    2, # x dimension
))</code></pre><p>The true parameter posterior (which we would like to learn using the simulated observations) is shown in the image below.</p><table><tr><th style="text-align: right"></th><th style="text-align: right"></th><th style="text-align: right"></th><th style="text-align: right"></th><th style="text-align: right"></th></tr><tr><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><img src="../img/post.png" alt="True Posterior"/></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr></table><h2 id="Sampling-Initial-Data"><a class="docs-heading-anchor" href="#Sampling-Initial-Data">Sampling Initial Data</a><a id="Sampling-Initial-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling-Initial-Data" title="Permalink"></a></h2><p>We can query our simulation for a few initial datapoints. One can sample a few random points from the parameter prior, or use for example LatinHypercubeSampling.jl to obtain a small initial grid.</p><p>We will query a few datapoints from the prior here using the following <code>get_init_data</code> function.</p><pre><code class="language-julia hljs">function get_init_data(count)
    X = reduce(hcat, (random_datapoint() for _ in 1:count))[:,:]
    Y = reduce(hcat, (gp_objective(x) for x in eachcol(X)))[:,:]
    return BOSS.ExperimentData(X, Y)
end

function random_datapoint()
    x = rand(x_prior)
    while !BOSS.in_bounds(x, bounds)
        x = rand(x_prior)
    end
    return x
end

init_data = get_init_data(3)</code></pre><h2 id="Problem-Hyperparameters"><a class="docs-heading-anchor" href="#Problem-Hyperparameters">Problem Hyperparameters</a><a id="Problem-Hyperparameters-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Hyperparameters" title="Permalink"></a></h2><p>Now we need to define the kernel and some priors. We use very weak priors here as if we knew very little about the true objective function. See the hyperparameter section for more information about hyperparameters.</p><p>We will use the <span>$Matérn_{\frac{3}{2}}$</span> kernel.</p><pre><code class="language-julia hljs">kernel = BOSS.Matern32Kernel()</code></pre><p>We define the length-scale priors so that they suppress any length scales below <span>$0.05$</span> or above <span>$10$</span>. The length-scale priors should be defined as a vector of multivariate distributions, where each distribution defines the prior for different observation dimension.</p><pre><code class="language-julia hljs">λ_prior = Product(fill(
    calc_inverse_gamma(0.05, 10.),
    2, # x dimension
))

lengthscale_priors = fill(
    λ_prior,
    1, # y dimension
)</code></pre><p>We define the amplitude priors to suppress amplitudes below <span>$0.1$</span> or above <span>$20$</span>. The amplitude priors should be defined as a vector of univariate distributions.</p><pre><code class="language-julia hljs">amplitude_priors = fill(
    calc_inverse_gamma(0.1, 20.),
    1, # y dimension
)</code></pre><p>We define the simulation noise deviation prior to suppress any deviations below <span>$0.0001$</span> or above <span>$0.1$</span>. (The true <em>unknown</em> simulation noise deviation has been set to <span>$0.001$</span>.) The noise deviation prior should be defined as a vector of univariate distributions.</p><pre><code class="language-julia hljs">noise_std_priors = fill(
    calc_inverse_gamma(0.0001, 0.1),
    1, # y dimension
)</code></pre><p>Finally, we wrap all the model hyperparameters into the <code>GaussianProcess</code> structure.</p><pre><code class="language-julia hljs">model = GaussianProcess(;
    kernel,
    lengthscale_priors,
    amplitude_priors,
    noise_std_priors,
)</code></pre><h2 id="Acquisition-Function"><a class="docs-heading-anchor" href="#Acquisition-Function">Acquisition Function</a><a id="Acquisition-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Acquisition-Function" title="Permalink"></a></h2><p>We need to define the acquisition function. The next evaluation point in each iteration is selected by maximizing this function. We will select new data by maximizing the posterior variance <span>$\mathbb{V}\left[ p(x|z_o) \right]$</span>.</p><pre><code class="language-julia hljs">acquisition = PostVarAcq()</code></pre><h2 id="Instantiate-BolfiProblem"><a class="docs-heading-anchor" href="#Instantiate-BolfiProblem">Instantiate <code>BolfiProblem</code></a><a id="Instantiate-BolfiProblem-1"></a><a class="docs-heading-anchor-permalink" href="#Instantiate-BolfiProblem" title="Permalink"></a></h2><p>Now, we can instantiate the <code>BolfiProblem</code>.</p><pre><code class="language-julia hljs">problem = BolfiProblem(init_data;
    f = gp_objective,
    domain = Domain(; bounds),
    acquisition
    model,
    likelihood,
    x_prior,
)</code></pre><h2 id="Running-BOLFI"><a class="docs-heading-anchor" href="#Running-BOLFI">Running BOLFI</a><a id="Running-BOLFI-1"></a><a class="docs-heading-anchor-permalink" href="#Running-BOLFI" title="Permalink"></a></h2><p>Before we run the BOLFI method, we need to define the methods used during the individual steps of the algorithm.</p><p>We need to define the algorithms used to estimate the model (hyper)parameters and maximize the acquisition. See the <a href="https://soldasim.github.io/BOSS.jl/stable/">BOSS.jl</a> package for more information about available model fitters and/or acquisition maximizers.</p><pre><code class="language-julia hljs">model_fitter = OptimizationMAP(;
    algorithm = NEWUOA(),
    parallel = true,
    multistart = 200,
    rhoend = 1e-2,
)
acq_maximizer = OptimizationAM(;
    algorithm = BOBYQA(),
    parallel = true,
    multistart = 200,
    rhoend = 1e-2,
)</code></pre><p>Finally, we need to defint the termination condition and we can use <code>BolfiOptions</code> to change some miscellaneous settings. (<em>One can for example define a custom <code>BolfiCallback</code> which is periodically called in each iteration of <code>bolfi!</code>.</em>)</p><pre><code class="language-julia hljs">term_cond = BOSS.IterLimit(25)

options = BolfiOptions(;
    info = true,
)</code></pre><p>Now, we have everything we need and we can call the main function <code>bolfi!</code>.</p><pre><code class="language-julia hljs">bolfi!(problem; model_fitter, acq_maximizer, term_cond, options)</code></pre><h1 id="Plots"><a class="docs-heading-anchor" href="#Plots">Plots</a><a id="Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Plots" title="Permalink"></a></h1><p>To visualize the algorithm, use the example script in the <a href="https://github.com/soldasim/BOLFI.jl/tree/master/examples/simple">github repo</a>. It implements the same problem described on this page, but additionally contains a custom callback for plotting.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../hyperparams/">« Hyperparameters</a><a class="docs-footer-nextpage" href="../example_lfss/">Example: LFSS »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 15 July 2025 16:20">Tuesday 15 July 2025</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
