<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simulator Inverse Problem · BOSIP.jl</title><meta name="title" content="Simulator Inverse Problem · BOSIP.jl"/><meta property="og:title" content="Simulator Inverse Problem · BOSIP.jl"/><meta property="twitter:title" content="Simulator Inverse Problem · BOSIP.jl"/><meta name="description" content="Documentation for BOSIP.jl."/><meta property="og:description" content="Documentation for BOSIP.jl."/><meta property="twitter:description" content="Documentation for BOSIP.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BOSIP.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">BOSIP.jl</a></li><li class="is-active"><a class="tocitem" href>Simulator Inverse Problem</a><ul class="internal"><li><a class="tocitem" href="#Problem-Definition"><span>Problem Definition</span></a></li><li><a class="tocitem" href="#Problem-Inputs"><span>Problem Inputs</span></a></li><li><a class="tocitem" href="#Problem-Output"><span>Problem Output</span></a></li><li class="toplevel"><a class="tocitem" href="#The-BOSIP-Method"><span>The BOSIP Method</span></a></li><li><a class="tocitem" href="#The-Proxy-Variable"><span>The Proxy Variable</span></a></li><li><a class="tocitem" href="#Surrogate-Model"><span>Surrogate Model</span></a></li><li><a class="tocitem" href="#Acquisition-Function"><span>Acquisition Function</span></a></li></ul></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../types/">Data Types</a></li><li><a class="tocitem" href="../hyperparams/">Hyperparameters</a></li><li><a class="tocitem" href="../example/">Example</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Simulator Inverse Problem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simulator Inverse Problem</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/soldasim/BOSIP.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/soldasim/BOSIP.jl/blob/master/docs/src/sip.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Simulator-Inverse-Problem"><a class="docs-heading-anchor" href="#Simulator-Inverse-Problem">Simulator Inverse Problem</a><a id="Simulator-Inverse-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Simulator-Inverse-Problem" title="Permalink"></a></h1><p>We use the term <em>simulator inverse problems</em> to refer to an inverse problem, where the forward model is represented by a (prohibitively expensive) simulator. The inverse problem is defined in a Bayesian way, and as such the goal is to learn the whole posterior distribution.</p><p>This section formally introduces the general Bayesian inverse problem as considered in BOSIP.jl.</p><table><tr><th style="text-align: right"></th><th style="text-align: right"></th><th style="text-align: right"></th><th style="text-align: right"></th><th style="text-align: right"></th></tr><tr><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><img src="../img/bosip.drawio.png" alt="BOSIP"/></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr></table><h2 id="Problem-Definition"><a class="docs-heading-anchor" href="#Problem-Definition">Problem Definition</a><a id="Problem-Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Definition" title="Permalink"></a></h2><p>The goal is to learn the posterior distribution</p><p class="math-container">\[p(x|z_o) = \frac{p(z_o|x) p(x)}{p(z_o)} \propto p(z_o|x) p(x)\]</p><p>to find which parameter values <span>$x$</span> could have produced the observation <span>$z_o$</span>.</p><p>The likelihood</p><p class="math-container">\[p(z_o|x) = p(z_o|y=f(x))\]</p><p>is composed of two parts; the observation likelihood <span>$p(z|y)$</span> available in a closed form describes the uncertainty of the observation <span>$z_o$</span>, and the mapping <span>$y = f(x)$</span> describes the studied system.</p><p>The user-defined prior <span>$p(x)$</span> is used to encode expert knowledge about the parameters.</p><h2 id="Problem-Inputs"><a class="docs-heading-anchor" href="#Problem-Inputs">Problem Inputs</a><a id="Problem-Inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Inputs" title="Permalink"></a></h2><p>The following are considered as inputs of the problem:</p><ul><li>the parameter prior <span>$p(x)$</span> together with the parameter domain <span>$\mathcal{D} \subset \mathbb{R}^{d_x}$</span></li><li>the real-world observation <span>$z_o \sim p(z_o|y_{true}=f(x_{true}))$</span></li><li>the observation likelihood <span>$p(z|y)$</span> in a closed form</li><li>a prohibitively expensive (noisy) blackbox simulator <span>$y = f(x) + \epsilon$</span></li></ul><h2 id="Problem-Output"><a class="docs-heading-anchor" href="#Problem-Output">Problem Output</a><a id="Problem-Output-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Output" title="Permalink"></a></h2><p>The goal is to learn an approximation of the posterior <span>$p(x|z_o)$</span>, describing not only a MAP estimate of the parameters <span>$x$</span>, but the whole distribution of likely values.</p><h1 id="The-BOSIP-Method"><a class="docs-heading-anchor" href="#The-BOSIP-Method">The BOSIP Method</a><a id="The-BOSIP-Method-1"></a><a class="docs-heading-anchor-permalink" href="#The-BOSIP-Method" title="Permalink"></a></h1><p>BOSIP.jl uses the Bayesian optimization (BO) procedure, handled by the BOSS.jl package, to efficiently train an approximation of the parameter posterior while minimizing the number of required expensive simulations.</p><p>The three key parts of the method are; <em>the acquisition function</em> used to sequentially select candidate parameters for simulations, <em>the probabilistic surrogate model</em> used to obtain a cheap approximation of the simulator together with uncertainty estimates, and <em>the proxy variable <span>$\delta$</span></em> defining the exact quantitiy modeled by the surrogate model.</p><h2 id="The-Proxy-Variable"><a class="docs-heading-anchor" href="#The-Proxy-Variable">The Proxy Variable</a><a id="The-Proxy-Variable-1"></a><a class="docs-heading-anchor-permalink" href="#The-Proxy-Variable" title="Permalink"></a></h2><p>The user must decide, which exact quantities are to be modeled by the surrogate model as a function of the parameters <span>$x$</span>. This choice is largely problem dependent and can have significant impact on the performance of the method.</p><p>The expensive simulator realizes the mapping <span>$y = f(x)$</span>, and the observation likelihood <span>$p(z|y)$</span> provides a closed form expression for mapping the simulation output <span>$y$</span> to the likelihood value <span>$\ell(x) = p(z_o|y=f(x))$</span>. In general, the surrogate model can be used to model any quantity &quot;between&quot; the simulation <span>$y$</span> and the likelihood value <span>$\ell$</span>. This way, the model can be used to estimate the likelihood <span>$\ell(x)$</span> while avoiding the need to evaluate the expensive simulator <span>$f(x)$</span>.</p><p>In general, it is not always reasonable to model the simulation outputs <span>$y(x)$</span> directly. For example, if the simulation output <span>$y$</span> has a huge dimensionality, modeling it will be inefficient. The other extreme is modeling the scalar log-likelihood <span>$\log \ell(x)$</span>. This, on the other hand, often discards too much information obtained from the simulator by compressing the output into a single value.</p><p>It is upon the user to define a suitable proxy variable <span>$\delta = \phi(y)$</span> to be modeled by the surrogate model. The uncertainty of the modeled proxy variable <span>$\delta(x)$</span> is then propagated into the uncertainty in the estimate of the likelihood value <span>$\ell(x) = p(z_o|x)$</span>.</p><p>Some examples of setting up BOSIP.jl to model different quantities are described below.</p><h3 id="Modeling-the-Simulation-Output"><a class="docs-heading-anchor" href="#Modeling-the-Simulation-Output">Modeling the Simulation Output</a><a id="Modeling-the-Simulation-Output-1"></a><a class="docs-heading-anchor-permalink" href="#Modeling-the-Simulation-Output" title="Permalink"></a></h3><p>To model the simulation output, one should provide the black-box simulator directly as the <span>$f$</span> function of the <a href="../types/#BOSIP.BosipProblem"><code>BosipProblem</code></a> structure, and use a suitable <a href="../types/#Likelihood"><code>Likelihood</code></a>, which defines the whole mapping from <span>$y$</span> to <span>$\ell = p(z_o|y)$</span>. For example, one may use the <a href="../types/#BOSIP.NormalLikelihood"><code>NormalLikelihood</code></a> if the observation noise <span>$p(z|y)$</span> is assumed to be normal.</p><p>This way, BOSIP.jl will use the surrogate model to model the whole simulation output <span>$y \in \mathbb{R}^{d_y}$</span>.</p><h3 id="Modeling-the-Log-Likelihood"><a class="docs-heading-anchor" href="#Modeling-the-Log-Likelihood">Modeling the Log-Likelihood</a><a id="Modeling-the-Log-Likelihood-1"></a><a class="docs-heading-anchor-permalink" href="#Modeling-the-Log-Likelihood" title="Permalink"></a></h3><p>To model the log-likelihood, one should compose the simulator with a subsequent mapping <span>$\phi$</span> into a single function <span>$f$</span> and provide it to the <a href="../types/#BOSIP.BosipProblem"><code>BosipProblem</code></a> structure. The mapping <span>$\phi$</span> should be defined as the log-pdf of the observation likelihood <span>$p(z|y)$</span>. I.e. the provided function <span>$f$</span> will take the parameters <span>$x$</span> as the input, evaluate the expensive simulation <span>$y = f(x)$</span>, and then map the simulation outputs <span>$y$</span> to a scalar log-likelihood value <span>$\log\ell = p(z_o|y)$</span>. In this case, the <a href="../types/#BOSIP.ExpLikelihood"><code>ExpLikelihood</code></a> should be provided as the <a href="../types/#Likelihood"><code>Likelihood</code></a>, which then only exponentiates the log-likelihood.</p><p>This way, BOSIP.jl will use the surrogate model to model the scalar log-likelihood <span>$\log p(z_o|x)$</span>.</p><h3 id="Modeling-Arbitrary-Proxy-Variable"><a class="docs-heading-anchor" href="#Modeling-Arbitrary-Proxy-Variable">Modeling Arbitrary Proxy Variable</a><a id="Modeling-Arbitrary-Proxy-Variable-1"></a><a class="docs-heading-anchor-permalink" href="#Modeling-Arbitrary-Proxy-Variable" title="Permalink"></a></h3><p>To model any arbitrary proxy variable <span>$\delta$</span> by the surrogate model, do the following. Define a mapping <span>$\phi$</span>, which maps the simulation outputs <span>$y$</span> to your proxy variable <span>$\delta$</span> by realizing <em>a part of</em> the observation likelihood pdf <span>$p(z_o|y)$</span>. Then define a second mapping <span>$\psi$</span>, such that <span>$(\psi \circ \phi)(y) = p(z_o|y)$</span>. In other words, the mapping <span>$\psi$</span> realized the <em>remaining part</em> of the observation likelihood pdf.</p><p>Compose the expensive simulator <span>$y = f(x)$</span> and the mapping <span>$\psi$</span> into a single function <code>f</code> and provide it to the <a href="../types/#BOSIP.BosipProblem"><code>BosipProblem</code></a>. Define a custom <a href="../types/#Likelihood"><code>Likelihood</code></a>, which realizes the remaining mapping <span>$\psi$</span> and provide it to the <a href="../types/#BOSIP.BosipProblem"><code>BosipProblem</code></a> as the <code>likelihood</code>.</p><h2 id="Surrogate-Model"><a class="docs-heading-anchor" href="#Surrogate-Model">Surrogate Model</a><a id="Surrogate-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Surrogate-Model" title="Permalink"></a></h2><p>The probabilistic surrogate model is used to approximate the expensive simulator based on the data from previous simulations. It models the proxy variable <span>$\delta$</span> as a function of the parameters <span>$x$</span>. It provides a posterior predictive distribution <span>$p(\delta|x)$</span>, which describes the current estimate of <span>$\delta$</span> for the given <span>$x$</span> together with the uncertainty in that estimate.</p><p>The default choice for the surrogate model is the <code>GaussianProcess</code> model.</p><h2 id="Acquisition-Function"><a class="docs-heading-anchor" href="#Acquisition-Function">Acquisition Function</a><a id="Acquisition-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Acquisition-Function" title="Permalink"></a></h2><p>The acquisition function <span>$\alpha: \mathbb{R}^{d_x} \rightarrow \mathbb{R}$</span> is maximized in each iteration in order to select the most promising candidate parameters</p><p class="math-container">\[x \in \arg\max \alpha(x)\]</p><p>for the next simulation. The current surrogate model is used to calculate the acquisition values <span>$\alpha(x)$</span>, thus avoiding the need for the expensive simulator when evaluating the acquisition function.</p><p>The most basic <a href="../types/#BOSIP.BosipAcquisition"><code>BosipAcquisition</code></a> is the <a href="../types/#BOSIP.MaxVar"><code>MaxVar</code></a>, which selects the point of maximal variance of the current posterior approximation as the next evalation point, effectively exploring the areas with the highest model uncertainty.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« BOSIP.jl</a><a class="docs-footer-nextpage" href="../functions/">Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Saturday 20 September 2025 09:56">Saturday 20 September 2025</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
